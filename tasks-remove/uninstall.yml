---
- name: "installing | installing the required software"
  become: yes

  yum:
    name: "{{ item }}"
    state: absent
  with_items:
    - unzip
    - MySQL-python
    - mysql-connector-python
    - policycoreutils-python
    - httpd
    - mariadb
    - mariadb-server
    - php56u
    - php56u-cli
    - php56u-common
    - php56u-gd
    - php56u-imap
    - php56u-intl
    - php56u-mbstring
    - php56u-mcrypt
    - php56u-mysqlnd
    - php56u-process
    - php56u-xml


- name: "Create a unique ID"
  local_action: command uuidgen
  register: new_uuid

- name: "check to see if {{ ncwebpath }} path exists."
  stat:
    path: "{{ ncwebpath }}"
  register: pnc

- name: "Preserve files from {{ ncwebpath }} to {{ ncwebpath }}.{{ new_uuid.stdout }}"
  command: "/bin/mv \"{{ ncwebpath }}\" \"{{ ncwebpath }}.{{ new_uuid.stdout }}\" "
  args:
    creates: "{{ ncwebpath }}.{{ new_uuid.stdout }}"
  when: pnc.stat.isdir is defined and pnc.stat.isdir

- name: "Remove {{ ncwebpath }} if it still exists"
  file:
    path: "{{ ncwebpath }}"
    state: absent
  when: pnc.stat.isdir is defined and pnc.stat.isdir
